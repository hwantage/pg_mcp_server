# PostgreSQL MCP ì„œë²„ ì˜ˆì œ

ì´ í”„ë¡œì íŠ¸ëŠ” PostgreSQL ë°ì´í„°ë² ì´ìŠ¤ì™€ ì—°ë™í•˜ì—¬ ì‚¬ìš©ì ì •ë³´ë¥¼ ì¡°íšŒí•˜ëŠ” MCP(Model Context Protocol) ì„œë²„ì˜ ë‘ ê°€ì§€ êµ¬í˜„ ë°©ì‹ì„ ì œê³µí•©ë‹ˆë‹¤.

## ğŸ“‹ í”„ë¡œì íŠ¸ êµ¬ì¡°

```
pg_mcp/
â”œâ”€â”€ pg_mcp.py          # STDIO ë°©ì‹ MCP ì„œë²„
â”œâ”€â”€ pg_mcp_sse.py      # SSE ë°©ì‹ MCP ì„œë²„  
â”œâ”€â”€ sample.env         # í™˜ê²½ë³€ìˆ˜ ì„¤ì • ì˜ˆì œ
â””â”€â”€ README.md          # í”„ë¡œì íŠ¸ ë¬¸ì„œ
```



## ğŸ” ë‘ ë°©ì‹ì˜ ì°¨ì´ì 

### STDIO ë°©ì‹ íŠ¹ì§•
- **í†µì‹  ë°©ì‹**: í‘œì¤€ ì…ì¶œë ¥(Standard Input/Output)ì„ í†µí•œ ë¡œì»¬ í†µì‹ 
- **ì‚¬ìš© í™˜ê²½**: ìš´ì˜ì²´ì œ ë‚´ì—ì„œ ì‹¤í–‰ë˜ëŠ” ì‘ìš© í”„ë¡œê·¸ë¨ê³¼ ì§ì ‘ ì—°ë™
- **êµ¬í˜„ ë³µì¡ë„**: ê°„ë‹¨í•œ êµ¬í˜„, ìµœì†Œí•œì˜ ì„¤ì • í•„ìš”
- **ì„±ëŠ¥**: ë¡œì»¬ í™˜ê²½ì—ì„œ ë¹ ë¥¸ í†µì‹ , ë„¤íŠ¸ì›Œí¬ ì˜¤ë²„í—¤ë“œ ì—†ìŒ
- **ìš©ë„**: ëª…ë ¹ì¤„ ë„êµ¬, ë¡œì»¬ MCP í´ë¼ì´ì–¸íŠ¸ì™€ì˜ ì§ì ‘ ì—°ë™

### SSE ë°©ì‹ íŠ¹ì§•
- **í†µì‹  ë°©ì‹**: HTTP ê¸°ë°˜ Server-Sent Eventsë¥¼ í†µí•œ ë„¤íŠ¸ì›Œí¬ í†µì‹ 
- **ì‚¬ìš© í™˜ê²½**: ì›¹ ë¸Œë¼ìš°ì €ì™€ ì›¹ ì„œë²„ ê°„, ì›ê²© í´ë¼ì´ì–¸íŠ¸ ì§€ì›
- **êµ¬í˜„ ë³µì¡ë„**: ìƒëŒ€ì ìœ¼ë¡œ ë³µì¡, HTTP ì„œë²„ ì„¤ì • í•„ìš”
- **ì„±ëŠ¥**: ë„¤íŠ¸ì›Œí¬ í†µì‹ ìœ¼ë¡œ ì¸í•œ ì˜¤ë²„í—¤ë“œ ì¡´ì¬, ì‹¤ì‹œê°„ ìŠ¤íŠ¸ë¦¬ë° ì§€ì›
- **ìš©ë„**: ì›¹ ê¸°ë°˜ ì• í”Œë¦¬ì¼€ì´ì…˜, ì›ê²© ì ‘ê·¼, ì‹¤ì‹œê°„ ë°ì´í„° í‘¸ì‹œ

### ìƒì„¸ ë¹„êµí‘œ

| **êµ¬ë¶„** | **STDIO ë°©ì‹** | **SSE ë°©ì‹** |
|----------|---------------|--------------|
| **í†µì‹  ë°©ì‹** | í‘œì¤€ ì…ì¶œë ¥ (ë¡œì»¬ I/O) | HTTP/SSE (ë„¤íŠ¸ì›Œí¬ í†µì‹ ) |
| **ì—°ê²° ëŒ€ìƒ** | ë¡œì»¬ MCP í´ë¼ì´ì–¸íŠ¸ | ì›¹ ê¸°ë°˜ í´ë¼ì´ì–¸íŠ¸/ì›ê²© í´ë¼ì´ì–¸íŠ¸ |
| **êµ¬í˜„ ë‚œì´ë„** | ê°„ë‹¨ | ìƒëŒ€ì ìœ¼ë¡œ ë³µì¡ |
| **ì„¤ì • ìš”êµ¬ì‚¬í•­** | ìµœì†Œí™” | HTTP ì„œë²„ ì„¤ì • í•„ìš” |
| **ì ‘ê·¼ì„±** | ë¡œì»¬ ì‹œìŠ¤í…œ ë‚´ë¶€ë§Œ | ë„¤íŠ¸ì›Œí¬ë¥¼ í†µí•œ ì›ê²© ì ‘ê·¼ |
| **ì£¼ìš” ì¥ì ** | ì„¤ì • ê°„ë‹¨, ë¹ ë¥¸ í†µì‹  | ì›ê²© ì ‘ê·¼, ì›¹ í˜¸í™˜ì„± |
| **ì£¼ìš” ë‹¨ì ** | ë¡œì»¬ í™˜ê²½ ì œí•œ | ì„œë²„ ì„¤ì • ë³µì¡, ë„¤íŠ¸ì›Œí¬ ì˜¤ë²„í—¤ë“œ |
| **ì í•©í•œ ì‚¬ìš© ì‚¬ë¡€** | ê°œë°œ/í…ŒìŠ¤íŠ¸, ë¡œì»¬ ë„êµ¬ | í”„ë¡œë•ì…˜, ì›¹ ì„œë¹„ìŠ¤ |

## ğŸš€ ì£¼ìš” ê¸°ëŠ¥

- **ì‚¬ìš©ì ì´ë¦„ìœ¼ë¡œ ì§ì› ì •ë³´ ì¡°íšŒ**: `search_user_by_name` ë„êµ¬ë¥¼ í†µí•´ ì§ì› ì •ë³´ ê²€ìƒ‰
- **ë‘ ê°€ì§€ ì„œë²„ ë°©ì‹ ì§€ì›**:
  - **STDIO ë°©ì‹**: í‘œì¤€ ì…ì¶œë ¥ì„ í†µí•œ í†µì‹ 
  - **SSE ë°©ì‹**: Server-Sent Eventsë¥¼ í†µí•œ ì›¹ ê¸°ë°˜ í†µì‹ 

## ğŸ“¦ ì„¤ì¹˜ ë° ì„¤ì •

### 1. ì˜ì¡´ì„± ì„¤ì¹˜

```bash
pip install mcp psycopg2-binary python-dotenv starlette uvicorn
```

### 2. í™˜ê²½ë³€ìˆ˜ ì„¤ì •

`sample.env` íŒŒì¼ì„ `.env`ë¡œ ë³µì‚¬í•˜ê³  ì‹¤ì œ ê°’ìœ¼ë¡œ ìˆ˜ì •í•˜ì„¸ìš”:

```bash
cp sample.env .env
```

`.env` íŒŒì¼ ì˜ˆì‹œ:
```env
# SSE ì„œë²„ ì„¤ì •
HOST=0.0.0.0
PORT=8000

# PostgreSQL ë°ì´í„°ë² ì´ìŠ¤ ì„¤ì •
DB_NAME=your_database
DB_USER=postgres
DB_PASSWORD=your_password
DB_HOST=localhost
DB_PORT=5432
```

### 3. PostgreSQL ë°ì´í„°ë² ì´ìŠ¤ ì¤€ë¹„

SSE ë°©ì‹ì„ ì‚¬ìš©í•˜ë ¤ë©´ ë‹¤ìŒê³¼ ê°™ì€ í…Œì´ë¸” êµ¬ì¡°ê°€ í•„ìš”í•©ë‹ˆë‹¤:

```sql
CREATE SCHEMA IF NOT EXISTS my_db;

CREATE TABLE my_db.users (
    userid SERIAL PRIMARY KEY,
    deptname VARCHAR(100) NOT NULL,
    empname VARCHAR(100) NOT NULL
);

-- í…ŒìŠ¤íŠ¸ ë°ì´í„° ì‚½ì…
INSERT INTO my_db.users (userid, deptname, empname) VALUES
(1, 'ê°œë°œíŒ€', 'í™ê¸¸ë™'),
(2, 'ì¸ì‚¬íŒ€', 'ì´ìˆœì‹ '),
(3, 'ì˜ì—…íŒ€', 'ê¹€ì² ìˆ˜');
```

## ğŸ–¥ï¸ ì‚¬ìš© ë°©ë²•

### STDIO ë°©ì‹ (pg_mcp.py)

í…ŒìŠ¤íŠ¸ ëª©ì ìœ¼ë¡œ ë”ë¯¸ ë°ì´í„°ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. MCP í˜¸ìŠ¤íŠ¸ ì•±ì— ë“±ë¡í•˜ì—¬ ì‚¬ìš©í•©ë‹ˆë‹¤.

**ì„œë²„ ì—°ê²° í…ŒìŠ¤íŠ¸ ë°©ë²•:**
* cursor ai IDE ì—ì„œ ì„¤ì • > Tools and Integrations ë©”ë‰´ì—ì„œ ìƒˆ mcp ì„œë²„ë¥¼ ë“±ë¡í•©ë‹ˆë‹¤.
* ì•„ë˜ì™€ ê°™ì´ mcp.json íŒŒì¼ì— ì„œë²„ë¥¼ ë“±ë¡í•©ë‹ˆë‹¤.
```json
{
  "mcpServers": {
    "pg_mcp": {
      "command": "python",
      "args": ["d:\\python\\pg_mcp\\pg_mcp.py"],
      "description": "PG MCP Server (STDIO ëª¨ë“œ)"
    }
  }
}
```

### SSE ë°©ì‹ (pg_mcp_sse.py)

ì‹¤ì œ PostgreSQL ë°ì´í„°ë² ì´ìŠ¤ì™€ ì—°ë™í•˜ì—¬ ì›¹ ê¸°ë°˜ìœ¼ë¡œ ì„œë¹„ìŠ¤ë¥¼ ì œê³µí•©ë‹ˆë‹¤. 

ì•„ë˜ì˜ ëª…ë ¹ì–´ë¡œ MCP ì„œë²„ë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤.
```bash
python pg_mcp_sse.py
```

**ì„œë²„ ì—°ê²° í…ŒìŠ¤íŠ¸ ë°©ë²•:**
- ì„œë²„ ì£¼ì†Œ: `http://localhost:8000/sse`

* cursor ai IDE ì—ì„œ ì„¤ì • > Tools and Integrations ë©”ë‰´ì—ì„œ ìƒˆ mcp ì„œë²„ë¥¼ ë“±ë¡í•©ë‹ˆë‹¤.
* ì•„ë˜ì™€ ê°™ì´ mcp.json íŒŒì¼ì— ì„œë²„ë¥¼ ë“±ë¡í•©ë‹ˆë‹¤.
```json
{
  "mcpServers": {
    "pg_mcp_sse": {
      "type": "http",
      "url": "http://127.0.0.1:8000/sse",
      "description": "PG MCP Server (HTTP ëª¨ë“œ)"
    }
  }
}
```


## ğŸ”§ API ì‚¬ìš©ë²•

### search_user_by_name ë„êµ¬

ì§ì› ì´ë¦„ìœ¼ë¡œ ì‚¬ìš©ì ì •ë³´ë¥¼ ì¡°íšŒí•©ë‹ˆë‹¤.

**ë§¤ê°œë³€ìˆ˜:**
- `empname` (string): ê²€ìƒ‰í•  ì§ì› ì´ë¦„

**ë°˜í™˜ê°’:**
```json
[
  {
    "userid": 1,
    "deptname": "ê°œë°œíŒ€", 
    "empname": "í™ê¸¸ë™"
  }
]
```

**ì˜¤ë¥˜ ì‘ë‹µ:**
```json
[
  {
    "error": "ì§ì› ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”."
  }
]
```


## ğŸ“„ ë¼ì´ì„ ìŠ¤

MIT
